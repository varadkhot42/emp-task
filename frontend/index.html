<!DOCTYPE html>
<html>
<head>
  <title>Employee Task Manager</title>
  <style>
    body {
      font-family: Arial;
      max-width: 800px;
      margin: auto;
      padding: 20px;
    }
    input, button {
      margin: 4px;
      padding: 6px;
    }
    pre {
      background: #111;
      color: #0f0;
      padding: 10px;
      max-height: 300px;
      overflow: auto;
    }
  </style>
</head>

<body>

<h2>ğŸ” Login</h2>
<input id="loginUser" placeholder="username">
<input id="loginPass" type="password" placeholder="password">
<button onclick="login()">Login</button>

<p id="loginStatus"></p>

<hr>

<h2>ğŸ“ Create Task (Admin)</h2>
<input id="taskTitle" placeholder="title">
<input id="taskDesc" placeholder="description">
<input id="taskAssign" placeholder="assigned user id">
<button onclick="createTask()">Create</button>

<hr>

<h2>ğŸ“‹ Tasks</h2>
<button onclick="loadTasks()">Load Tasks</button>
<pre id="tasksBox"></pre>

<script>

const API_BASE = "http://13.233.113.109:5000"; 

let TOKEN = "";

function login() {
  fetch(`${API_BASE}/login`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
      username: loginUser.value,
      password: loginPass.value
    })
  })
  .then(r => r.json())
  .then(d => {
    if (d.token) {
      TOKEN = d.token;
      loginStatus.innerText = "âœ… Logged in as " + d.role;
    } else {
      loginStatus.innerText = "âŒ " + JSON.stringify(d);
    }
  });
}

function createTask() {
  fetch(`${API_BASE}/tasks`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Authorization": "Bearer " + TOKEN
    },
    body: JSON.stringify({
      title: taskTitle.value,
      description: taskDesc.value,
      assigned_user_id: parseInt(taskAssign.value)
    })
  })
  .then(r => r.json())
  .then(d => alert(JSON.stringify(d)));
}

function loadTasks() {
  fetch(`${API_BASE}/tasks`, {
    headers: {
      "Authorization": "Bearer " + TOKEN
    }
  })
  .then(r => r.json())
  .then(d => {
      tasksBox.innerText = JSON.stringify(d, null, 2);
  });
}

</script>

</body>
</html>
